# コンビニの勤怠システムを作る
# 要件定義
## 解決したいこと
- コンビニで勤怠管理を電子化する
- 打刻、労働時間の管理をwebで管理したい
## 機能一覧
### 店舗設定機能
- 管理者は、勤労日の定義等を設定することができる
- 勤労日の定義等を変更した場合、反映されるのは、翌月から
- 管理者は、責任者とメンバーの作成、編集、削除ができる
### 打刻機能
- メンバー/責任者を選択して、出勤ができる
- メンバー/責任者を選択して、退勤ができる
- メンバー/責任者を選択して、休始ができる
- メンバー/責任者を選択して、休了ができる
### 勤労時間管理機能
- メンバーは、自分の1ヶ月間の労働合計と、日毎の労働時間を確認することができる
- 責任者は、自分とメンバー全員の1ヶ月間の労働合計と、日毎の労働時間を確認することができる
- 労働時間が8時間以上の場合は、自動的に1時間の休憩を付与する
- 労働時間が6時間以上8時間未満の場合は、自動的に45分の休憩を付与する
- 勤務間インターバル制度は考慮しない(努力義務のため)
- 出勤・退勤/休始・休了のセットが揃っていない場合は、エラー打刻とする
- 出勤・退勤が1日に複数ある場合は、エラー打刻とする
### 申請機能
- メンバー/責任者は、打刻の削除を責任者に申請できる(責任者は、自分自身を選べない)
- メンバー/責任者は、打刻の追加を責任者に申請できる責任者は、自分自身を選べない)
- メンバー/責任者は、自分の申請を取り消すことができる
- メンバー責任者は、承認済みの申請は取り消すことができない
### 承認機能
-エラーや未承認の打刻以外は月末にまとめて自動承認する
-責任者は、自分に提出された申請内容を確認し、承認および巻き戻しができる

# 基本設計
## 画面設計
- [画面遷移図](specification/screen_transition.drawio)を[drawio](https://app.diagrams.net/)で読み込んでください
## 機能設計
- [API仕様書](specification/api_document.yml)を[Swagger Editor](https://editor.swagger.io/)に貼り付けて確認してください。
- Swagger Editorの書き方は[こちら](https://qiita.com/teinen_qiita/items/e440ca7b1b52ec918f1b)
## データ設計
- [ER設計図](specification/api_document.yml)を[drawio](https://app.diagrams.net/)で読み込んでください

# 実装方法がわかっていないこと
- 出勤・退勤/休始・休了のセットが揃っていない場合は、エラー打刻とする
  - attendancesにstart_timeとend_timeカラムを付与し、これが揃っていないとエラーとする
  - 画面上で出勤が押さたら、退勤しか押せないようにする(休憩も同様に)
  - 打刻を修正するときは、セットで修正
- 出勤・退勤が1日に複数ある場合は、エラー打刻とする
  - 画面上で出勤が押されるタイミングで、同月に出勤がないか確認し、存在すれば出勤を押せなくする
  - 打刻を修正するときも同様で、申請する前に確認する
- エラーや未承認の打刻以外は月末にまとめて自動承認する
  - アイデア1:承認する打刻は、requestsのapprove_atがnullでないattendance
# 参考文献
## 環境構築
https://github.com/nisshiy30/attendance/blob/main/docs/%E7%92%B0%E5%A2%83%E6%A7%8B%E7%AF%89.md
## 実装要件
https://github.com/nisshiy30/attendance/blob/main/docs/%E5%AE%9F%E8%A3%85%E8%A6%81%E4%BB%B6.md
